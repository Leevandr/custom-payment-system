# Custom Payment Processing System

## Описание

Данный проект представляет собой систему обработки платежей, которая считывает данные из файлов,
парсит их в реальном времени и сохраняет информацию о платежах в базе данных.

Система также обрабатывает возможные ошибки, такие как дублирующиеся или некорректные записи.
Система составляет репорты по платежам которые прошли первичную валидацию(По имени файла, по формату строк)


## Стек

* Java 21
* Spring boot 3.3.3
* Hibernate 6.5.2
* Spring Data JPA
* H2 DataBase
* Lombok
* SLF4J

## Функциональные возможности

* Чтение существующих и парсинг новых файлов с платежами.
* Поддержка различных статусов платежей.
  *  `OK (1):` Платеж успешно обработан.
  *  `PARTIAL_OK (98):` Файл содержит как валидные, так и невалидные записи.
  *  `NOT_OK (99):` Платеж невалиден.
  *  `FULL_SAVED (2):` Все записи в файле валидны.
  *  `DUPLICATE (97):` Платеж дублируется.
* Генерация отчетов о статусах платежей.

## Установка

### 1. Клонируйте репозиторий
```https://github.com/Leevandr/custom-payment-system.git```
### 2. Перейдите в директорию проекта
```cd custom-payment-system```
### 3. Для сборки проекта используйте
```./gradlew build```
### 4. Конфигурация
Так как нам нужно иметь доступ к любым папкам и в силу специфической работы аннотации @Value
необходимо написать полный путь(можно написать путь от root проекта, но спринг будет брать файлы из папки build,
а это нам не очень удобно.

[application.yaml](src%2Fmain%2Fresources%2Fapplication.yaml)
```
spring:
  input:
    directory: "Путь до Input в resources(начиная с диска)"
```

Вот пример - его нужно поменять на пути в **вашей системе**!!

[application.yaml](src%2Fmain%2Fresources%2Fapplication.yaml)
```
input:
    directory: C:\Users\levandr\IdeaProjects\custom-payment-system\src\main\resources\Input
  output:
    error: C:\Users\levandr\IdeaProjects\custom-payment-system\src\main\resources\Output\ReportError
    success: C:\Users\levandr\IdeaProjects\custom-payment-system\src\main\resources\Output\ReportSuccess
```

### 5. Формат файлов

Файлы должны иметь имя в формате `BCP_YYYYMMDD_HHMMSS_XXXX`, где `YYYYMMDD` - дата, а `HHMMSS` - время.
Каждая строка файла должна соответствовать следующему формату:

```
123456789012 123456789-123456789-123456789-123456789-1234567890 Наименование                                                     012345678912 100000000.00
```
* Позиция 0-11: номер записи (12 символов)
* Позиция 13-62: ID платежа (50 символов)
* Позиция 64-128: имя компании (64 символов)
* Позиция 130-141: ИНН плательщика (12 символов)
* Позиция 143-155: сумма (формат 1.00) (12 символов)

### 6. Логи
Логи приложения можно найти в консоли при запуске. Они содержат информацию о процессе обработки платежей, включая предупреждения и ошибки.



